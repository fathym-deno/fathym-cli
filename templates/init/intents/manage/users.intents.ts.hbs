import { CommandIntent } from '@fathym/cli';
import UsersCommand from '../../commands/manage/users.ts';

const origin = import.meta.resolve('../../.cli.ts');

// âœ… Default users list (no flags)
CommandIntent('lists users by default', UsersCommand, origin)
  .Args([])
  .Flags({})
  .ExpectLogs('ðŸ‘¥ Listing users...')
  .ExpectExit(0)
  .Run();

// âœ… List all users including inactive
CommandIntent('lists all users including inactive', UsersCommand, origin)
  .Args([])
  .Flags({ all: true })
  .ExpectLogs('ðŸ‘¥ Listing users...', 'Including inactive users')
  .ExpectExit(0)
  .Run();

// âœ… Dry run suppresses listing
CommandIntent('dry run prevents listing', UsersCommand, origin)
  .Args([])
  .Flags({ 'dry-run': true })
  .ExpectLogs('ðŸ›‘ Dry run: Would list users')
  .ExpectExit(0)
  .Run();
