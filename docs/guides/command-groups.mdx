---
FrontmatterVersion: 1
DocumentType: Guide
Title: Command Groups
Summary: Guide to organizing CLI commands into hierarchical groups.
Created: 2025-11-30
Updated: 2025-11-30
Owners:
  - fathym
References:
  - Label: Documentation Index
    Path: ../README.mdx
  - Label: Authoring Commands
    Path: ./authoring-commands.mdx
  - Label: Configuration
    Path: ../concepts/configuration.mdx
---

# Command Groups

Command groups organize related commands into hierarchical namespaces. This guide explains how to create, configure, and use command groups in your CLI.

## Overview

Groups let you structure commands logically:

```bash
# Flat structure (without groups)
mycli deploy-staging
mycli deploy-production
mycli scaffold-component
mycli scaffold-service

# Grouped structure (with groups)
mycli deploy staging
mycli deploy production
mycli scaffold component
mycli scaffold service
```

## Creating Groups

Groups are created using directories in your `commands/` folder. Each subdirectory becomes a group.

### Directory Structure

```
commands/
â”œâ”€â”€ deploy/                    # Group: deploy
â”‚   â”œâ”€â”€ .metadata.ts          # Group metadata (optional)
â”‚   â”œâ”€â”€ staging.ts            # Command: deploy staging
â”‚   â””â”€â”€ production.ts         # Command: deploy production
â”œâ”€â”€ scaffold/                  # Group: scaffold
â”‚   â”œâ”€â”€ .metadata.ts          # Group metadata
â”‚   â”œâ”€â”€ component.ts          # Command: scaffold component
â”‚   â””â”€â”€ service.ts            # Command: scaffold service
â””â”€â”€ init.ts                    # Root command: init
```

### Invocation

```bash
# Root commands
mycli init

# Grouped commands
mycli deploy staging
mycli deploy production
mycli scaffold component
mycli scaffold service
```

## Group Metadata

Create a `.metadata.ts` file in the group directory to define group information:

```typescript
// commands/scaffold/.metadata.ts
export default {
  Name: 'scaffold',
  Description: 'Code generation and scaffolding commands',
  Usage: 'mycli scaffold <generator> [options]',
  Examples: [
    'mycli scaffold component Button',
    'mycli scaffold service AuthService',
    'mycli scaffold hook useAuth',
  ],
};
```

### Metadata Properties

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `Name` | `string` | Yes | Group display name |
| `Description` | `string` | No | Brief description |
| `Usage` | `string` | No | Usage pattern |
| `Examples` | `string[]` | No | Example invocations |

### Without Metadata

Groups work without `.metadata.ts`, but help output will be minimal:

```bash
$ mycli scaffold --help
# Shows only list of subcommands
```

With metadata:

```bash
$ mycli scaffold --help

ðŸ“˜ Group: scaffold
Code generation and scaffolding commands

Usage:
  mycli scaffold <generator> [options]

Examples:
  mycli scaffold component Button
  mycli scaffold service AuthService

ðŸ”¸ Available Commands
  component - Generate a new component
  service - Generate a new service
```

## Nested Groups

Groups can be nested to any depth:

```
commands/
â””â”€â”€ db/                        # Group: db
    â”œâ”€â”€ .metadata.ts
    â”œâ”€â”€ migrate/               # Subgroup: db migrate
    â”‚   â”œâ”€â”€ .metadata.ts
    â”‚   â”œâ”€â”€ up.ts             # Command: db migrate up
    â”‚   â”œâ”€â”€ down.ts           # Command: db migrate down
    â”‚   â””â”€â”€ status.ts         # Command: db migrate status
    â””â”€â”€ seed/                  # Subgroup: db seed
        â”œâ”€â”€ .metadata.ts
        â”œâ”€â”€ run.ts            # Command: db seed run
        â””â”€â”€ reset.ts          # Command: db seed reset
```

Invocation:

```bash
mycli db migrate up
mycli db migrate down
mycli db migrate status
mycli db seed run
mycli db seed reset
```

## Commands Within Groups

Commands in groups are regular commands:

```typescript
// commands/deploy/staging.ts
import { Command } from '@fathym/cli';

export default Command('deploy/staging', 'Deploy to staging environment')
  .Run(async ({ Log }) => {
    Log.Info('Deploying to staging...');
    // deployment logic
    Log.Success('Deployed to staging!');
  });
```

The command key includes the group path (`deploy/staging`), but users invoke it with spaces (`deploy staging`).

## Group-Level Commands

A group can have its own command that runs when called without subcommands:

```
commands/
â””â”€â”€ scaffold/
    â”œâ”€â”€ .metadata.ts
    â”œâ”€â”€ scaffold.ts           # Runs for: mycli scaffold
    â”œâ”€â”€ component.ts          # Runs for: mycli scaffold component
    â””â”€â”€ service.ts            # Runs for: mycli scaffold service
```

```typescript
// commands/scaffold/scaffold.ts
import { Command } from '@fathym/cli';

export default Command('scaffold', 'Interactive scaffolding wizard')
  .Run(async ({ Log }) => {
    Log.Info('Starting interactive scaffold wizard...');
    // show interactive menu
  });
```

## Multiple Command Sources

You can organize groups across multiple directories using `.cli.json`:

```json
{
  "Name": "My CLI",
  "Tokens": ["mycli"],
  "Version": "1.0.0",
  "Commands": [
    { "Path": "./commands" },
    { "Path": "./plugins", "Root": "plugins" }
  ]
}
```

Structure:

```
my-cli/
â”œâ”€â”€ commands/
â”‚   â”œâ”€â”€ init.ts              # mycli init
â”‚   â””â”€â”€ build.ts             # mycli build
â””â”€â”€ plugins/
    â””â”€â”€ analytics/
        â”œâ”€â”€ .metadata.ts
        â””â”€â”€ track.ts         # mycli plugins analytics track
```

### Root Prefix

The `Root` option prefixes all commands from that source:

```json
{
  "Commands": [
    { "Path": "./core-commands" },
    { "Path": "./experimental", "Root": "experimental" }
  ]
}
```

Experimental commands are namespaced:

```bash
mycli experimental new-feature
```

## Help Navigation

Groups appear in help output with navigation hints:

```bash
$ mycli --help

ðŸ“˜ My CLI v1.0.0
A powerful command-line tool

ðŸ”¸ Available Commands
  init - Initialize a project
  build - Build the project

ðŸ”¸ Available Groups
  deploy - Deployment commands
  scaffold - Code generation commands
```

```bash
$ mycli deploy --help

ðŸ“˜ Group: deploy
Deployment commands

ðŸ”¸ Available Commands
  staging - Deploy to staging
  production - Deploy to production
```

## Best Practices

### 1. Group Related Commands

```
# Good - logical grouping
commands/
â”œâ”€â”€ auth/
â”‚   â”œâ”€â”€ login.ts
â”‚   â”œâ”€â”€ logout.ts
â”‚   â””â”€â”€ status.ts
â””â”€â”€ project/
    â”œâ”€â”€ init.ts
    â”œâ”€â”€ build.ts
    â””â”€â”€ deploy.ts

# Bad - flat with long names
commands/
â”œâ”€â”€ auth-login.ts
â”œâ”€â”€ auth-logout.ts
â”œâ”€â”€ auth-status.ts
â”œâ”€â”€ project-init.ts
â”œâ”€â”€ project-build.ts
â””â”€â”€ project-deploy.ts
```

### 2. Keep Nesting Shallow

Two levels of nesting is usually sufficient:

```bash
# Good
mycli db migrate up
mycli scaffold component Button

# Potentially confusing
mycli cloud aws ec2 instance create --name foo
```

### 3. Provide Group Metadata

Always create `.metadata.ts` for groups:

```typescript
// commands/deploy/.metadata.ts
export default {
  Name: 'deploy',
  Description: 'Deploy applications to various environments',
  Examples: [
    'mycli deploy staging',
    'mycli deploy production --skip-tests',
  ],
};
```

### 4. Consistent Naming

Use consistent verb-noun patterns:

```
commands/
â”œâ”€â”€ generate/          # verb-based group
â”‚   â”œâ”€â”€ component.ts
â”‚   â””â”€â”€ service.ts
â”œâ”€â”€ run/               # verb-based group
â”‚   â”œâ”€â”€ tests.ts
â”‚   â””â”€â”€ build.ts
```

Or noun-based:

```
commands/
â”œâ”€â”€ components/        # noun-based group
â”‚   â”œâ”€â”€ create.ts
â”‚   â””â”€â”€ delete.ts
â”œâ”€â”€ services/          # noun-based group
â”‚   â”œâ”€â”€ create.ts
â”‚   â””â”€â”€ delete.ts
```

## Example: Full CLI Structure

```
my-cli/
â”œâ”€â”€ .cli.json
â”œâ”€â”€ commands/
â”‚   â”œâ”€â”€ init.ts
â”‚   â”œâ”€â”€ build.ts
â”‚   â”œâ”€â”€ deploy/
â”‚   â”‚   â”œâ”€â”€ .metadata.ts
â”‚   â”‚   â”œâ”€â”€ staging.ts
â”‚   â”‚   â”œâ”€â”€ production.ts
â”‚   â”‚   â””â”€â”€ preview.ts
â”‚   â”œâ”€â”€ scaffold/
â”‚   â”‚   â”œâ”€â”€ .metadata.ts
â”‚   â”‚   â”œâ”€â”€ component.ts
â”‚   â”‚   â”œâ”€â”€ service.ts
â”‚   â”‚   â””â”€â”€ hook.ts
â”‚   â””â”€â”€ db/
â”‚       â”œâ”€â”€ .metadata.ts
â”‚       â”œâ”€â”€ migrate/
â”‚       â”‚   â”œâ”€â”€ .metadata.ts
â”‚       â”‚   â”œâ”€â”€ up.ts
â”‚       â”‚   â”œâ”€â”€ down.ts
â”‚       â”‚   â””â”€â”€ status.ts
â”‚       â””â”€â”€ seed/
â”‚           â”œâ”€â”€ .metadata.ts
â”‚           â”œâ”€â”€ run.ts
â”‚           â””â”€â”€ reset.ts
â””â”€â”€ deno.jsonc
```

Usage:

```bash
mycli init my-project
mycli build
mycli deploy staging
mycli deploy production --force
mycli scaffold component Header
mycli db migrate up
mycli db migrate status
mycli db seed run
```

## Related

- [Authoring Commands](./authoring-commands.mdx) - Writing commands
- [Configuration](../concepts/configuration.mdx) - `.cli.json` options
- [Distribution](./distribution.mdx) - Compiling and distributing
