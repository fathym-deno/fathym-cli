---
FrontmatterVersion: 1
DocumentType: Concept
Title: Configuration
Summary: Understanding CLI project structure and .cli.json configuration.
Created: 2025-11-29
Updated: 2025-11-29
Owners:
  - fathym
References:
  - Label: Documentation Index
    Path: ../README.mdx
  - Label: ftm init
    Path: ../api/init.mdx
  - Label: CLI Lifecycle
    Path: ./cli-lifecycle.mdx
---

# Configuration

Every Fathym CLI project is driven by a declarative configuration. This page explains the project structure and configuration files.

## Project Structure

After `ftm init`, your project looks like this:

```txt
my-cli/
├── .cli.json          # Primary config (tokens, paths, etc.)
├── .cli.init.ts       # Optional init hook (IoC, services)
├── deno.jsonc         # Deno tooling config
├── commands/          # Command implementations
├── intents/           # Intent-driven CLI tests
├── templates/         # Optional scaffolding templates
├── .gitignore         # Preconfigured for builds
└── .vscode/           # IDE configuration (optional)
```

## File Reference

| File / Folder | Purpose | Created By | Editable |
|---------------|---------|------------|----------|
| `.cli.json` | CLI identity and config | `ftm init` | Yes |
| `.cli.init.ts` | IoC initialization hook | `ftm init` | Yes |
| `commands/` | Command logic | `ftm init` | Yes |
| `intents/` | Command tests | `ftm init` | Yes |
| `templates/` | Scaffolding templates | Manual | Yes |
| `.build/` | Embedded CLI output | `ftm build` | No |
| `.dist/` | Native binary output | `ftm compile` | No |
| `.temp/` | Runtime cache | dev/test flows | No |

## .cli.json

The root configuration file defining CLI identity:

```json
{
  "Name": "My CLI",
  "Tokens": ["my-cli", "mc"],
  "Version": "1.0.0",
  "Description": "My awesome CLI tool",
  "Commands": "./commands"
}
```

### Properties

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `Name` | string | Yes | Display name for help output |
| `Tokens` | string[] | Yes | CLI entry point names (first is primary) |
| `Version` | string | Yes | Semantic version |
| `Description` | string | No | Brief description |
| `Commands` | string | No | Commands directory (default: `./commands`) |

### Tokens

The `Tokens` array defines how users invoke your CLI:

```json
{
  "Tokens": ["my-cli", "mc"]
}
```

- First token (`my-cli`) becomes the primary binary name
- Additional tokens (`mc`) become aliases during install

## .cli.init.ts

Optional bootstrap hook that runs before any command dispatches:

```typescript
import type { CLIInitFn } from '@fathym/cli';

export default ((ioc) => {
  // Register shared services
  ioc.Register(MyService, () => new MyService());

  // Configure logging
  ioc.Register('LogLevel', () => 'debug');
}) satisfies CLIInitFn;
```

Use cases:
- Inject shared services into IoC container
- Set logging/debug modes
- Register dynamic runtime behaviors

## commands/

Each file exports a command:

```typescript
// commands/hello.ts
import { Command } from '@fathym/cli';
import { z } from 'zod';

export default Command('hello', 'Prints a greeting')
  .Args(z.tuple([z.string().optional()]))
  .Run(({ Params, Log }) => {
    Log.Info(`Hello, ${Params.Arg(0) ?? 'World'}!`);
  });
```

Commands are discovered automatically by the CLI runtime.

## intents/

Declarative tests for CLI behavior:

```typescript
// intents/hello.intents.ts
import { CommandIntents } from '@fathym/cli';

CommandIntents('my-cli hello', ({ Intent }) => {
  Intent('greets with default')
    .Args([])
    .ExpectLogs(['Hello, World!'])
    .ExpectExit(0);
});
```

Run with `ftm test` or `deno test`.

## templates/

Optional scaffolding templates using Handlebars syntax:

```txt
templates/
└── component/
    ├── {{name}}.ts.hbs
    └── {{name}}.test.ts.hbs
```

Templates are used when you add generator commands to your CLI.

## deno.jsonc

Local Deno configuration (not used by CLI runtime):

```json
{
  "name": "@my-org/my-cli",
  "version": "1.0.0",
  "imports": {
    "@fathym/cli": "jsr:@fathym/cli@0.0.82"
  },
  "tasks": {
    "build": "deno task fmt && deno task lint && deno task test",
    "test": "deno test -A"
  }
}
```

## Build Output

During build and compile, these directories are created:

```txt
my-cli/
├── .build/                      # Generated by `ftm build`
│   ├── cli.ts                   # Entry module
│   ├── EmbeddedCommandModules.ts
│   ├── EmbeddedCLIFileSystemHooks.ts
│   ├── embedded-templates.json
│   └── embedded-command-entries.json
├── .dist/                       # Generated by `ftm compile`
│   └── my-cli                   # Native binary
└── .temp/                       # Ephemeral runtime cache
```

These directories should be in `.gitignore`.

## Related

- [ftm init](../api/init.mdx) - Project initialization
- [CLI Lifecycle](./cli-lifecycle.mdx) - Build/compile workflow
- [Templates](./templates.mdx) - Scaffolding system
